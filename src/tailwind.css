@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom utilities (safe) */
@layer utilities {
  .contain-paint { contain: paint; }
  .backface-hidden { backface-visibility: hidden; }
}


@layer base {
  /* antes estava 80px; deixe 0 por padrão */
  :root { --nav-h: 0px; }
  .hero-viewport { box-sizing: border-box; } /* garante que o padding não estoura o layout */
  html, body {
    @apply overflow-x-hidden max-w-full bg-black text-white scroll-smooth;
  }
  body, button, a {
    font-family: 'JetBrains Mono', monospace;
  }
}

@layer utilities {
  .glitch-text {
    text-shadow: 2px 0 #00ff00, -2px 0 #ff00ff, 0 2px #00ffff, 0 -2px #ff0080;
  }
  .navbar {
    @apply fixed inset-x-0 top-0 z-[100] flex items-center py-3 border-b border-cyan-200/20;
    background: rgba(0,0,0,.95);
    backdrop-filter: blur(10px);
  }
  .hero-viewport {
    height: calc(100vh - var(--nav-h));
  }
  .hero-video {
    @apply absolute inset-0 w-full h-full;
    object-fit: cover;
    filter: saturate(1) contrast(1.05);
  }
  .hero-overlay {
    @apply absolute inset-0 pointer-events-none;
    z-index: 1;
    background: radial-gradient(60% 60% at 50% 50%, rgba(0,0,0,.25) 0%, rgba(0,0,0,.95) 100%);
  }
}

/* === Custom CSS migrado do inline === */
@layer components {
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
:root{--nav-h:80px;--hero-ui-gap:120px;}
*{box-sizing:border-box;}
html,body{overflow-x:hidden;max-width:100vw;background:#000;color:#fff;scroll-behavior:smooth;}
body,button,a{font-family:'JetBrains Mono',monospace;}
.glitch-text{text-shadow:2px 0 #00ff00,-2px 0 #ff00ff,0 2px #00ffff,0 -2px #ff0080;}
.container{max-width:1200px;margin-inline:auto;padding-inline:1.25rem;}.navbar{position:fixed;inset:0 0 auto 0;z-index:100;display:flex;align-items:center;padding:12px 0;background:rgba(0,0,0,.95);backdrop-filter:blur(10px);border-bottom:1px solid rgba(0,255,255,.2);}#home{position:relative;isolation:isolate;overflow:hidden;padding-top:0;min-height:100vh;}@supports (height:100svh){#home{min-height:100svh;}}@supports (height:100dvh){#home{min-height:100dvh;}}.hero-viewport{position:relative;height:calc(var(--vh,100vh) - var(--nav-h));}@supports (height:100svh){.hero-viewport{height:calc(100svh - var(--nav-h));}}@supports (height:100dvh){.hero-viewport{height:calc(100dvh - var(--nav-h));}}.hero-media-wrapper{position:absolute;inset:0;z-index:0;overflow:hidden;}.hero-video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:saturate(1) contrast(1.05);}.hero-overlay{position:absolute;inset:0;z-index:1;pointer-events:none;background:radial-gradient(60% 60% at 50% 40%,rgba(0,0,0,0.2) 0%,rgba(0,0,0,0.65) 60%,rgba(0,0,0,0.85) 100%),linear-gradient(to bottom,rgba(0,0,0,.4),rgba(0,0,0,.75));}.carousel{position:relative;width:100%;height:100%;overflow:hidden;}.carousel-track{display:flex;height:100%;transition:transform 600ms ease;will-change:transform;}.carousel-item{flex:0 0 100%;min-width:100%;height:100%;}.hero-slide{height:calc(100% - var(--hero-ui-gap));display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:0 1rem;min-height:0;}.hero-slide h1{margin-bottom:.5rem;}.hero-slide h2{margin-bottom:.75rem;}.carousel-nav-btn{position:absolute;top:calc(50% - var(--hero-ui-gap)/2);transform:translateY(-50%);width:56px;height:56px;border-radius:9999px;border:2px solid #06b6d4;color:#06b6d4;background:rgba(0,0,0,.35);display:grid;place-items:center;font-size:28px;line-height:1;z-index:40;transition:all .2s ease;}.carousel-prev{left:1rem;}.carousel-next{right:1rem;}.carousel-nav-btn:hover{background:rgba(0,0,0,.6);box-shadow:0 0 24px rgba(6,182,212,.35);}.hero-ui{position:absolute;inset:0;z-index:30;display:grid;grid-template-rows:1fr auto auto;justify-items:center;align-items:end;padding-bottom:env(safe-area-inset-bottom,0);pointer-events:none;}.hero-ui .cta-stack,.hero-ui .carousel-indicators,.carousel-nav-btn{pointer-events:auto;}.cta-stack{display:flex;gap:1rem;flex-wrap:wrap;justify-content:center;margin-bottom:clamp(8px,1.6vh,14px);}.carousel-indicators{margin-bottom:clamp(6px,1.4vh,12px);background:rgba(0,0,0,.5);padding:10px 18px;border-radius:20px;border:1px solid #00ffff;display:flex;gap:10px;}.carousel-indicator{width:10px;height:10px;border-radius:9999px;border:2px solid #00ffff;background:transparent;cursor:pointer;transition:all .2s ease;}.carousel-indicator.active,.carousel-indicator:hover{background:#00ffff;}.clip-path-button{clip-path:polygon(0 0,calc(100% - 10px) 0,100% 100%,10px 100%);border-radius:0;min-width:140px;text-align:center;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;}a.btn-diag{--btn-bg:#ec4899;--btn-fg:#000;--btn-slant:12px;position:relative;display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;line-height:1;color:var(--btn-fg);text-decoration:none;overflow:hidden;transition:transform .2s ease,box-shadow .2s ease,color .2s ease;}a.btn-diag::before{content:"";position:absolute;inset:0;z-index:0;background:var(--btn-bg);clip-path:polygon(0 0,calc(100% - var(--btn-slant)) 0,100% 100%,var(--btn-slant) 100%);}a.btn-diag>span{position:relative;z-index:1;display:inline-flex;align-items:center;justify-content:center;padding:.9rem 2.25rem;font-weight:800;letter-spacing:.15em;text-transform:uppercase;white-space:nowrap;line-height:1;}a.btn-diag:hover{transform:translateY(-2px);box-shadow:0 0 0 4px rgba(0,229,255,.15),0 10px 30px rgba(255,45,170,.25);color:#fff;}.glow{position:absolute;border-radius:9999px;filter:blur(40px);opacity:.18;}#about,#games,#values,#contact{scroll-margin-top:var(--nav-h);}[data-reveal]{opacity:0;transform:translateY(16px) scale(.985);transition:transform .8s cubic-bezier(.22,.61,.36,1),opacity .8s ease;will-change:transform,opacity;}[data-reveal].is-visible{opacity:1;transform:none;}[data-reveal-from="up"]{transform:translateY(22px);}[data-reveal-from="down"]{transform:translateY(-22px);}[data-reveal-from="left"]{transform:translateX(28px);}[data-reveal-from="right"]{transform:translateX(-28px);}[data-reveal-from="zoom"]{transform:scale(.96);}[data-reveal][data-reveal-dur="fast"]{transition-duration:.5s;}[data-reveal][data-reveal-dur="slow"]{transition-duration:1.2s;}.game-card{position:relative;height:400px;perspective:1000px;cursor:pointer;border:2px solid transparent;transition:all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);border-radius:12px;overflow:hidden;transform:translateY(0);box-shadow:0 4px 20px rgba(0,0,0,0.3);}@media (min-width:768px){.game-card{height:450px;}}@media (min-width:1024px){.game-card{height:500px;}}@media (min-width:1440px){.game-card{height:560px;}}@media (min-width:2560px){.game-card{height:620px;}}.game-card:hover{border-color:rgba(6,182,212,0.8);transform:translateY(-8px) scale(1.02);box-shadow:0 0 30px rgba(6,182,212,0.4),0 20px 40px rgba(0,0,0,0.4);}.card-3d{position:relative;width:100%;height:100%;transform-style:preserve-3d;transition:transform 0.8s cubic-bezier(0.23,1,0.320,1);will-change:transform;}.game-card.is-flipped .card-3d{transform:rotateY(180deg);}.card-face{position:absolute;inset:0;backface-visibility:hidden;border:2px solid;overflow:hidden;background:rgba(17,24,39,0.95);backdrop-filter:blur(12px);display:flex;flex-direction:column;border-radius:10px;transition:all 0.3s ease;}.card-front{border-color:#06b6d4;background:linear-gradient(135deg,rgba(17,24,39,0.98),rgba(30,41,59,0.95));}.card-back{border-color:#ec4899;transform:rotateY(180deg);background:linear-gradient(135deg,rgba(17,24,39,0.98),rgba(40,30,50,0.95));}.card-header{background:rgba(30,41,59,0.9);border-bottom:1px solid rgba(6,182,212,0.3);position:relative;overflow:hidden;}.card-header::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(6,182,212,0.1),transparent);animation:shimmer 3s infinite;}@keyframes shimmer{0%{left:-100%;}50%{left:-100%;}100%{left:100%;}}.card-content{animation:fadeInUp 0.6s ease-out;}@keyframes fadeInUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}.floating-icon{animation:floating 3s ease-in-out infinite;}@keyframes floating{0%,100%{transform:translateY(0);}50%{transform:translateY(-10px);}}.typewriter{overflow:hidden;white-space:nowrap;animation:typing 2s steps(20,end),blink-caret 0.75s step-end infinite;}@keyframes typing{from{width:0;}to{width:100%;}}@keyframes blink-caret{from,to{border-color:transparent;}50%{border-color:#06b6d4;}}.pulse-badge{animation:pulseBadge 2s ease-in-out infinite;}@keyframes pulseBadge{0%,100%{transform:scale(1);opacity:1;}50%{transform:scale(1.05);opacity:0.8;}}.neon-text{animation:neonGlow 2s ease-in-out infinite alternate;}@keyframes neonGlow{from{text-shadow:0 0 5px currentColor,0 0 10px currentColor,0 0 15px currentColor;}to{text-shadow:0 0 10px currentColor,0 0 20px currentColor,0 0 30px currentColor;}}@media (min-width:1440px){.card-face .p-4{padding:1.5rem;}.card-face h3{font-size:1.25rem;margin-bottom:1rem;}.card-face p,.card-face li{font-size:0.925rem;line-height:1.6;}.card-back ul{margin-bottom:1.5rem;}.card-back .mt-4{margin-top:1.5rem;padding:1rem;}}.slide-in-left{animation:slideInLeft 1s ease-out;}@keyframes slideInLeft{from{opacity:0;transform:translateX(-50px);}to{opacity:1;transform:translateX(0);}}.pulse-grow{animation:pulseGrow 3s ease-in-out infinite;}@keyframes pulseGrow{0%,100%{transform:scale(1);}50%{transform:scale(1.05);}}.rotate-slow{animation:rotateSlow 20s linear infinite;}@keyframes rotateSlow{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}.fade-in-scale{animation:fadeInScale 0.8s ease-out;}@keyframes fadeInScale{from{opacity:0;transform:scale(0.9);}to{opacity:1;transform:scale(1);}}.progress-bar{position:relative;background:rgba(255,255,255,0.1);border-radius:10px;overflow:hidden;}.progress-fill{height:4px;background:linear-gradient(90deg,#06b6d4,#ec4899,#10b981);border-radius:10px;transform-origin:left;animation:progressFill 2s ease-out;}@keyframes progressFill{from{transform:scaleX(0);}to{transform:scaleX(1);}}.scan-line{position:relative;overflow:hidden;}.scan-line::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:2px;background:linear-gradient(90deg,transparent,#00ffff,transparent);animation:scanLine 3s infinite;}@keyframes scanLine{0%{left:-100%;}100%{left:100%;}}#about,#games,#values,#contact{padding-block:clamp(56px,8vh,96px);border-top:2px solid #1f2937;}#mobile-menu{z-index:9999;}.contact-panel{position:relative;}.contact-deco{position:absolute;pointer-events:none;will-change:transform;contain:layout paint;}.contact-deco.br{top:-0.25rem;right:0;transform:translateX(0.375rem);}.contact-deco.bl{bottom:-0.25rem;left:0;transform:translateX(-0.5rem);}.contact-deco.ml{top:50%;left:0;transform:translate(-0.25rem,-50%);}.contact-deco.br{width:1.5rem;height:1.5rem;}.contact-deco.bl{width:1rem;height:1rem;}.contact-deco.ml{width:0.75rem;height:3rem;}@media (min-width:768px){.contact-deco.br{right:-0.5rem;transform:none;}.contact-deco.bl{left:-0.5rem;transform:none;}.contact-deco.ml{left:-0.25rem;transform:translateY(-50%);}}#contact *{min-width:0;}.contact-grid{display:grid;gap:4rem;align-items:start;grid-template-columns:1fr;}@media (min-width:1024px){.contact-grid{grid-template-columns:minmax(0,1fr) minmax(0,560px);gap:4rem;}}.contact-right{width:100%;max-width:560px;min-width:0;overflow:hidden;margin-inline:auto;}.contact-terminal{display:block;width:100%;max-width:560px;border-radius:0.75rem;overflow:hidden;}.contact-wrap{word-break:break-word;overflow-wrap:anywhere;}.contact-stats{display:grid;grid-template-columns:1fr;gap:1rem;}@media (min-width:480px){.contact-stats{grid-template-columns:repeat(2,minmax(0,1fr));}}@media (min-width:768px){.contact-stats{grid-template-columns:repeat(3,minmax(0,1fr));}}
}


/* --- CLS guards --- */
@layer components {
  .hero-viewport { contain: layout paint; }
  .hero-media-wrapper { aspect-ratio: 2000/2000; }
  .hero-video { width: 100%; height: 100%; object-fit: cover; }
  .cta-stack { min-height: 96px; } /* reserve space for buttons */
  .carousel-indicators { min-height: 20px; }
}

@layer components {
  /* Flip perf modes */
  .card-3d { transform-style: preserve-3d; transition: transform .45s cubic-bezier(.2,.8,.2,1), opacity .25s ease; }
  .card-face { backface-visibility: hidden; will-change: auto; }
  .game-card { contain: layout paint; }
  .game-card.wc .card-face, .game-card.wc .card-3d { will-change: transform, opacity; }
  html.lite-anim .card-3d { transform: none !important; }
  html.lite-anim .card-front, html.lite-anim .card-back { position: absolute; inset: 0; }
  html.lite-anim .card-back { opacity: 0; transition: opacity .25s ease; }
  html.lite-anim .card-front { opacity: 1; transition: opacity .25s ease; }
  @media (hover: hover) and (pointer: fine) {
    html.lite-anim .game-card:hover .card-back { opacity: 1; }
    html.lite-anim .game-card:hover .card-front { opacity: 0; }
  }
  html.lite-anim .game-card.is-flipped .card-back { opacity: 1; }
  html.lite-anim .game-card.is-flipped .card-front { opacity: 0; }

  /* Pause transitions offscreen */
  .game-card.paused .card-3d,
  .game-card.paused .card-face { transition: none !important; }

  /* Flip hint (arrow) */
  .flip-hint {
    position: absolute; right: .75rem; bottom: .75rem;
    display: flex; align-items: center; justify-content: center;
    width: 2.25rem; height: 2.25rem; border-radius: 9999px;
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(2px);
    border: 1px solid rgba(255,255,255,0.18);
    pointer-events: none;
    transform: translateZ(0);
    opacity: .85;
  }
  .flip-hint-icon { fill: #fff; opacity: .9; }
  @media (hover: hover) and (pointer: fine) {
    .game-card:hover .flip-hint { opacity: 1; }
  }
  @media (hover: none) and (pointer: coarse) {
    .flip-hint { animation: flipHintPulse 1.8s ease-in-out infinite; }
  }
  @keyframes flipHintPulse {
    0%,100% { transform: translateZ(0) scale(1); opacity: .8; }
    50%     { transform: translateZ(0) scale(1.08); opacity: 1; }
  }
}

@layer components {
  .is-flipped .card-3d {
    transform: rotateY(180deg);
    will-change: transform;
  }

  /* low-perf: remove 3D e usa opacidade; !important para vencer regras minificadas */
  .bi-low-perf .is-flipped .card-3d {
    transform: none !important;
  }

  .bi-low-perf .card-face.card-back {
    opacity: 0;
    pointer-events: none;
  }
  .bi-low-perf .is-flipped .card-face.card-front {
    opacity: 0;
    pointer-events: none;
  }
  .bi-low-perf .is-flipped .card-face.card-back {
    opacity: 1;
    pointer-events: auto;
  }

  /* transições leves */
  .card-face {
    transition: transform .5s ease, opacity .22s ease;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transform: translateZ(0);
    will-change: transform, opacity;
  }

  /* respeita reduced motion sempre */
  @media (prefers-reduced-motion: reduce) {
    .card-3d, .card-face { transition: none !important; }
    .is-flipped .card-3d { transform: none !important; }
  }

  /* segurança extra: quando Battery API sinalizar economia, marca também */
  .bi-battery-saver .is-flipped .card-3d {
    transform: none !important;
  }

  @media (hover: none) and (pointer: coarse) {
    :root { --nav-h: calc(64px + env(safe-area-inset-top, 0px)); } /* valor inicial; será refinado por JS */
    [data-reveal] {
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
    }

    .hero-viewport {
      /* mantém o hero com altura total do viewport MENOS a navbar,
        e empurra o conteúdo interno (inset:0) para baixo da navbar */
      padding-top: var(--nav-h);
      height: calc(100svh - var(--nav-h));
      box-sizing: border-box; /* garante que o padding entra na caixa sem estourar layout */
    }

    /* âncoras: só no mobile precisamos compensar a navbar fixa */
    [id] { scroll-margin-top: var(--nav-h); }
    .hero, .carousel, .hero-slide { scroll-margin-top: calc(var(--nav-h) + 8px); }
  }

  /* 1) Limite transições a propriedades baratas (nada de 'all' e box-shadow) */
  #games .game-card{
    transition: transform .28s cubic-bezier(.2,.8,.2,1), border-color .2s ease;
  }
  #games .game-card:hover{
    transform: translateY(-6px) scale(1.01);
    /* sombra mais leve para reduzir blur radius */
    box-shadow: 0 8px 22px rgba(0,0,0,.32);
  }

  /* 2) Card faces: só transform/opacity (já ajuda o flip/crossfade) */
  #games .card-face{
    transition: transform .45s ease, opacity .22s ease;
  }

  /* 3) Desligue blur no mobile (coarse) por padrão — liga só em desktop */
  @media (hover:none) and (pointer:coarse){
    #games .card-face{ backdrop-filter: none !important; }
  }

  /* 4) Renderização preguiçosa dos cards offscreen (Chromium / Safari 17+) */
  @supports (content-visibility: auto){
    #games .game-card{
      content-visibility: auto;
      contain-intrinsic-size: 500px 300px; /* reserva de layout aproximada */
    }
  }

  /* 6) 'will-change' só quando necessário (classe .wc será ligada por JS) */
  #games .game-card.wc .card-3d,
  #games .game-card.wc .card-face{
    will-change: transform, opacity;
  }

  #games .game-card{
    box-shadow: 0 4px 16px rgba(0,0,0,.28);
  }
  #games .game-card:hover{
    box-shadow: 0 10px 24px rgba(0,0,0,.34);
  }

  /* O contêiner do card não recebe transform (não achata o 3D do filho) */
  #games .game-card { transform: none !important; }

  /* 3D robusto */
  #games .game-card { perspective: 1000px; }
  #games .card-3d    { transform-style: preserve-3d; transition: transform .6s cubic-bezier(.2,.8,.2,1); }
  #games .card-face  { -webkit-backface-visibility: hidden; backface-visibility: hidden; transform: translateZ(0.01px); }
  #games .card-front { transform: rotateY(0deg)   translateZ(0.01px) !important; }
  #games .card-back  { transform: rotateY(180deg) translateZ(0.01px) !important; }

  /* Flip via classe (seu JS de click-only mantém isso) */
  #games .game-card.is-flipped .card-3d { transform: rotateY(180deg); }
  #games .game-card { touch-action: manipulation; -webkit-tap-highlight-color: rgba(0,0,0,0); }

  /* Low-perf ainda vira cross-fade */
  .bi-low-perf #games .is-flipped .card-3d { transform: none !important; }
  .bi-low-perf #games .card-face.card-back { opacity: 0; pointer-events: none; }
  .bi-low-perf #games .is-flipped .card-face.card-front { opacity: 0; pointer-events: none; }
  .bi-low-perf #games .is-flipped .card-face.card-back  { opacity: 1; pointer-events: auto; }

  .flip-indicator {
    position: absolute;
    bottom: 20px;
    right: 20px;
    display: flex;
    align-items: center;
    gap: 8px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
    font-weight: 500;
    letter-spacing: 0.5px;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
  }

  .flip-icon {
    font-size: 16px;
    animation: rotateHint 2s infinite ease-in-out;
  }

  .card-3d:hover .flip-indicator {
    opacity: 1;
    transform: translateY(0);
  }

  @keyframes rotateHint {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(180deg); }
  }

  /* Mobile responsive adjustments */
  @media (max-width: 768px) {
    .flip-indicator {
      opacity: 1;
      transform: translateY(0);
    }

    .flip-indicator span {
      font-size: 11px;
    }
  }

  /* Touch feedback for mobile */
  @media (hover: none) {        
    .flip-indicator {
      opacity: 1;
      transform: translateY(0);
    }
  }
}