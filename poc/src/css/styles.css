@import "tailwindcss/base";
@import "tailwindcss/components";
@import "tailwindcss/utilities";

/* ==== Legacy styles appended ==== */
*{margin:0;padding:0;box-sizing:border-box;touch-action:manipulation;-webkit-tap-highlight-color:transparent}
    body{font-family:Inter,Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#14213d 0%,#0b132b 100%);color:#e0e1dd;height:100vh;overflow:hidden;display:flex;flex-direction:column}
    a{color:#90e0ef}
    #game-header{padding:12px 15px;background:rgba(13,27,42,.95);border-bottom:2px solid #778da9;z-index:10;display:flex;justify-content:space-between;align-items:center}
    #game-container{flex:1;position:relative;overflow:hidden}
    #game-canvas{position:absolute;top:0;left:0;width:100%;height:100%;background:#1b263b}
    #hud{position:absolute;top:15px;left:15px;background:rgba(13,27,42,.8);padding:10px;border-radius:10px;z-index:5;display:flex;flex-direction:column;gap:5px;max-width:60%}
    #vocabulary-count,#time-display,#location-display{font-size:.8rem}
    #map-button{position:absolute;top:15px;right:15px;background:rgba(13,27,42,.85);border:1px solid #778da9;border-radius:8px;padding:8px 12px;color:#e0e1dd;font-size:.8rem;z-index:6}
    #job-button{position:absolute;top:15px;right:95px;background:rgba(13,27,42,.85);border:1px solid #778da9;border-radius:8px;padding:8px 12px;color:#e0e1dd;font-size:.8rem;z-index:6}
    #controls{position:absolute;bottom:20px;left:20px;width:140px;height:140px;z-index:6}
    #joystick{position:absolute;width:70px;height:70px;background:rgba(65,90,119,.75);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#e0e1dd;font-size:11px;text-align:center;user-select:none;touch-action:none;border:2px solid #778da9}
    #interact-btn{position:absolute;bottom:20px;right:20px;width:86px;height:86px;background:rgba(65,90,119,.75);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#e0e1dd;font-size:12px;text-align:center;z-index:6;border:2px solid #778da9}
    #npc-hint{position:absolute;bottom:120px;right:20px;background:rgba(13,27,42,.8);border:1px solid #778da9;border-radius:10px;padding:8px 10px;font-size:.8rem;display:none;z-index:6}
    #dialogue-box{position:absolute;bottom:100px;left:15px;right:15px;background:rgba(13,27,42,.96);border:2px solid #778da9;border-radius:12px;padding:15px;z-index:7;display:none;box-shadow:0 0 15px rgba(0,0,0,.6)}
    #dialogue-text{margin-bottom:15px;line-height:1.45;font-size:.95rem;max-height:200px;overflow-y:auto;padding:5px}
    #response-options{display:flex;flex-direction:column;gap:8px;max-height:200px;overflow-y:auto;padding:5px}
    .word-option{background:#415a77;border:none;border-radius:8px;padding:10px;color:#e0e1dd;font-size:.9rem;cursor:pointer;transition:all .2s;text-align:left}
    .word-option:active{background:#778da9;transform:scale(.98)}
    .word-option.unknown{background:#2d3748;color:#718096;cursor:not-allowed}
    #close-dialogue{position:absolute;top:-10px;right:-10px;width:28px;height:28px;background:#e63946;border:2px solid #778da9;border-radius:50%;color:#fff;font-weight:700;display:flex;align-items:center;justify-content:center;font-size:.9rem;cursor:pointer}
    #notification{position:absolute;top:20px;left:50%;transform:translateX(-50%);background:rgba(13,27,42,.9);padding:10px 15px;border-radius:20px;z-index:100;font-size:.85rem;display:none;text-align:center;max-width:80%}
    /* overlays: generic */
    .overlay{position:absolute;inset:0;display:none}
    .overlay[style*="display: none"]{pointer-events:none}
    .panel{background:#1b263b;border:2px solid #778da9;border-radius:14px;padding:18px;color:#e0e1dd}
    /* Dictionary */
    #dict-overlay{ position:fixed; inset:0; background:rgba(13,27,42,.96); display:none; z-index:9999; align-items:center; justify-content:center; padding:24px; }
    #dict-card{ width:min(560px,92vw); background:#1b263b; border:2px solid #778da9; border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.45); padding:18px; color:#e0e1dd; }
    #dict-title{ font-size:1.2rem; color:#e9c46a; margin-bottom:8px; }
    #dict-actions{ margin-top:14px; display:flex; gap:10px; justify-content:flex-end; }
    .dict-word { border: none; background: rgba(0,0,0,.06); padding: 0 4px; border-radius: 4px; cursor: pointer; }
    .dict-word:hover { outline: 1px dashed rgba(0,0,0,.2); }
    .dict-tooltip { font-size: 12px; margin-left: 6px; opacity: .85; }
    .btn{ background:#415a77; border:none; border-radius:10px; color:#e0e1dd; padding:10px 16px; font-size:.95rem; cursor:pointer;}
    .badge{ display:inline-block; background:#e63946; color:#fff; padding:2px 8px; border-radius:999px; font-size:.75rem; margin-left:8px; }
    .learned-word{color:#90e0ef;font-weight:700;border-bottom:1px dotted #94d2bd}
    .unknown-word{ text-decoration: underline dashed; cursor:pointer; color:#e0e1dd; }
    /* Minigame */
    #minigame-overlay{position:absolute; inset:0; background:rgba(0,0,0,.85); display:none; z-index:80; align-items:center; justify-content:center; flex-direction:column; touch-action:none; -webkit-user-select:none; user-select:none;}
    #minigame-canvas{background:#0e1826; border:0; margin:0; box-shadow:0 0 0 2px #778da9 inset; border-radius:10px; max-width:95vw; max-height:70vh; touch-action:none; display:block;}

    /* Battle (turn-based JP) */
    #battle-overlay{position:absolute;inset:0;background:rgba(0,0,0,.85);display:none;z-index:95;align-items:center;justify-content:center;padding:20px}
    #battle-card{width:min(720px,92vw);background:#1b263b;border:2px solid #778da9;border-radius:14px;padding:18px;color:#e0e1dd;box-shadow:0 10px 30px rgba(0,0,0,.45)}
    #battle-title{font-size:1.2rem;color:#e9c46a;margin-bottom:10px}
    #hp-wrap{display:flex;align-items:center;gap:10px;margin-bottom:12px}
    #hp-bar{flex:1;height:12px;background:#0e1826;border:1px solid #778da9;border-radius:999px;overflow:hidden}
    #hp-fill{height:100%;width:100%;background:#2a9d8f;transition:width .2s}
    #hp-text{font-size:.9rem}
    #battle-instr{opacity:.9;margin-bottom:10px}
    #battle-pool, #battle-ordered{display:flex;flex-wrap:wrap;gap:8px;min-height:44px;padding:8px;border:1px dashed #778da9;border-radius:10px;margin-bottom:10px}
    .word-chip{background:#415a77;border:none;border-radius:999px;color:#e0e1dd;padding:8px 12px;font-size:.95rem;cursor:pointer}
    .word-chip.disabled {
      opacity: 0.4;
      cursor: not-allowed;  /* visual */
    }
    .word-chip.wrong { animation: chipShake .18s linear 1; }
    @keyframes chipShake {
      0% { transform: translateX(0) }
      25% { transform: translateX(-3px) }
      50% { transform: translateX(3px) }
      100% { transform: translateX(0) }
    }
    #battle-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:8px}
    .btn{background:#415a77;border:none;border-radius:10px;color:#e0e1dd;padding:10px 16px;font-size:.95rem;cursor:pointer}

    /* Defense mini-skill */
    #defense-panel{
      position: relative;       /* fica dentro do card */
      z-index: 130;             /* acima dos chips/barras */
      margin-top: 10px;
      background: rgba(13,27,42,.9);
      border: 1px solid #778da9;
      border-radius: 10px;
      padding: 10px;
      pointer-events: auto;
    }
    #defense-panel[hidden]{
      display: none !important;
      pointer-events: none !important;
    }

    /* Input e timer */
    #defense-row{ display:flex; align-items:center; gap:8px; margin-top:8px; }
    #defense-input{ flex:1; padding:8px; border-radius:8px; border:1px solid #778da9; background:#0e1826; color:#e0e1dd; }
    #defense-timer{ min-width:48px; text-align:right; opacity:.9; }

    /* Enemy HP */
    #enemyhp-wrap{display:flex;align-items:center;gap:10px;margin:8px 0 14px}
    #enemyhp-text{font-size:.9rem}
    #enemyhp-bar{flex:1;height:12px;background:#0e1826;border:1px solid #778da9;border-radius:999px;overflow:hidden}
    #enemyhp-fill{height:100%;width:100%;background:#e76f51;transition:width .2s}

    /* Skills overlay */
    #skills-overlay{position:absolute;inset:0;background:rgba(0,0,0,.7);display:none;z-index:98;align-items:center;justify-content:center;padding:20px}
    #skills-card{width:min(520px,92vw);background:#1b263b;border:2px solid #778da9;border-radius:14px;padding:16px;color:#e0e1dd;box-shadow:0 10px 30px rgba(0,0,0,.45)}
    #skills-title{font-size:1.1rem;color:#e9c46a;margin-bottom:10px}
    #skills-list{display:flex;flex-direction:column;gap:8px}
    .skill-item{background:#415a77;border:none;border-radius:10px;color:#e0e1dd;padding:10px 14px;text-align:left;cursor:pointer;font-size:.95rem}
    #skills-actions{display:flex;justify-content:flex-end;gap:10px;margin-top:12px}

    #enemyhp-fill.hit { animation: hpBlink .35s ease-in-out 1; }
    @keyframes hpBlink {
      0% { filter: brightness(1.4); }
      100% { filter: brightness(1); }
    }

    #turn-banner {
      position: absolute; top: 14%; left: 50%; transform: translateX(-50%);
      background: rgba(233,196,106,.95); color:#0b132b;
      padding: 10px 16px; border-radius: 999px; font-weight: 700;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      opacity: 0; pointer-events: none; transition: opacity .18s, transform .18s;
      z-index: 120;
    }
    #turn-banner.show { opacity: 1; transform: translateX(-50%) scale(1.05); }

    /* --- HP flashes --- */
    #hp-fill.hit, #enemyhp-fill.hit { animation: hpBlink .35s ease-in-out 1; }
    @keyframes hpBlink { 0%{filter:brightness(1.5)} 100%{filter:brightness(1)} }

    /* --- Screenshake leve quando leva dano --- */
    .shake { animation: shake .18s linear 1; }
    @keyframes shake {
      0% { transform: translate(0,0) }
      25% { transform: translate(-3px,0) }
      50% { transform: translate(3px,0) }
      100% { transform: translate(0,0) }
    }

    /* --- Floater de dano --- */
    .damage-floater {
      position:absolute; color:#e76f51; font-weight:700; text-shadow:0 2px 6px rgba(0,0,0,.35);
      animation: dmgFloat .6s ease-out forwards; pointer-events:none; z-index:121;
    }
    @keyframes dmgFloat {
      0% { opacity:1; transform: translateY(0) }
      100% { opacity:0; transform: translateY(-20px) }
    }

    /* Defense panel: quando escondido, não bloqueia clique */
    #defense-panel { pointer-events:auto; }
    #defense-panel[hidden] { display:none !important; pointer-events:none !important; }

    /* Overlay (só se não tiver) para turn banner container */
    #battle-card { position: relative; }

    /* ===== VICTORY FX ===== */
    #victory-overlay {
      position:absolute; inset:0; z-index:200;
      display:none; align-items:center; justify-content:center;
      pointer-events:none;
    }

    .victory-flash {
      position:absolute; inset:0; background:radial-gradient(circle at 50% 50%, rgba(255,255,255,.85), rgba(255,255,255,0) 60%);
      animation: vicFlash .7s ease-out 1;
    }
    @keyframes vicFlash { from {opacity:0} 20%{opacity:1} to{opacity:0} }

    .victory-burst {
      position:absolute; width:220vmax; height:220vmax; border-radius:50%;
      background: radial-gradient(closest-side, rgba(233,196,106,.35), rgba(233,196,106,0) 60%);
      mix-blend-mode: screen; transform: scale(0.2); opacity:0;
      animation: vicBurst .9s ease-out forwards;
    }
    @keyframes vicBurst { 0%{opacity:0; transform:scale(0.2)} 30%{opacity:1} 100%{opacity:0; transform:scale(1)} }

    .victory-banner {
      position:relative;
      background:linear-gradient(135deg, #e9c46a, #f4d35e);
      color:#0b132b; padding:16px 26px; border-radius:999px;
      font-weight:900; font-size:1.4rem; letter-spacing:.04em;
      box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 2px 0 rgba(255,255,255,.6);
      transform: scale(.8); opacity:0;
      animation: vicBanner .6s cubic-bezier(.2,1.4,.2,1) .15s forwards;
      text-transform:uppercase;
    }
    @keyframes vicBanner { to { transform:scale(1); opacity:1 } }

    .victory-banner::before, .victory-banner::after {
      content:"";
      position:absolute; top:50%; width:120px; height:2px; opacity:.8;
      background:linear-gradient(to right, transparent, rgba(233,196,106,1));
    }
    .victory-banner::before { left:-130px; transform:translateY(-50%); }
    .victory-banner::after  { right:-130px; transform:translateY(-50%) rotate(180deg); }

    .victory-coins, .victory-confetti {
      position:absolute; inset:0; overflow:hidden; pointer-events:none;
    }
    .vic-piece {
      position:absolute; width:10px; height:10px; border-radius:50%;
      animation: vicFall linear forwards;
    }
    @keyframes vicFall {
      0%   { transform: translateY(-10vh) rotate(0deg); opacity:1 }
      100% { transform: translateY(100vh) rotate(600deg); opacity:0.8 }
    }

    /* shake o card do inimigo para “morrer” */
    .victory-shake { animation: vicShake .4s ease-in-out 2; }
    @keyframes vicShake {
      0%{ transform:translate(0,0) } 25%{ transform:translate(-4px,0)} 50%{ transform:translate(4px,0)} 100%{ transform:translate(0,0)}
    }

    /* fade out suave do overlay todo */
    .victory-out { animation: vicOut .35s ease-out forwards; }
    /* === Earthquake (full viewport) === */
    #eq-overlay{
      position: fixed; inset: 0; z-index: 180; display: none;
      pointer-events: auto;        /* recebe cliques nas peças */
    }

    #eq-matrix{
      position: absolute; inset: 0;
      width: 100vw; height: 100vh; /* cobre o viewport */
      opacity: 0.35;
    }

    #eq-layer{                     /* camada das peças clicáveis */
      position: absolute; inset: 0;
      width: 100vw; height: 100vh;
    }

    .eq-piece{
      position: absolute;
      padding: 6px 10px; border-radius: 8px;
      background: rgba(20,255,120,0.14);
      border: 1px solid rgba(80,255,160,0.35);
      color: #aaffcc; font-weight: 700; user-select: none; cursor: pointer;
      text-shadow: 0 0 6px rgba(0,255,140,.6);
      will-change: transform;
      transform: translate3d(0,0,0);
    }
    .eq-piece.sel{ outline:2px solid #e9c46a; background:rgba(233,196,106,.2); color:#fff; }

    /* tremor no card (opcional manter) */
    #battle-card.quake { animation: quakeShake .08s linear infinite; }
    @keyframes quakeShake {
      0%{ transform:translate(0,0) rotate(0deg) }
      25%{ transform:translate(-2px,1px) rotate(-0.2deg) }
      50%{ transform:translate(2px,-1px) rotate(0.2deg) }
      75%{ transform:translate(-1px,-2px) rotate(0deg) }
      100%{ transform:translate(0,0) rotate(0deg) }
    }
    /* Skills modal bem simples */
    #skills-modal{
      position:absolute; inset:0; display:none; z-index:170;
      align-items:center; justify-content:center; background:rgba(0,0,0,.55);
    }
    #skills-card{
      background:#0e1826; border:1px solid #778da9; border-radius:12px;
      padding:14px; min-width:260px; color:#e0e1dd; box-shadow:0 10px 30px rgba(0,0,0,.4);
    }
    #skills-list .skill-btn{ width:100%; margin-top:8px; }
